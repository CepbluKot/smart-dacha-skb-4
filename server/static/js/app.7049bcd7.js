(function(e){function t(t){for(var o,a,r=t[0],s=t[1],d=t[2],u=0,v=[];u<r.length;u++)a=r[u],Object.prototype.hasOwnProperty.call(i,a)&&i[a]&&v.push(i[a][0]),i[a]=0;for(o in s)Object.prototype.hasOwnProperty.call(s,o)&&(e[o]=s[o]);l&&l(t);while(v.length)v.shift()();return c.push.apply(c,d||[]),n()}function n(){for(var e,t=0;t<c.length;t++){for(var n=c[t],o=!0,r=1;r<n.length;r++){var s=n[r];0!==i[s]&&(o=!1)}o&&(c.splice(t--,1),e=a(a.s=n[0]))}return e}var o={},i={app:0},c=[];function a(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=o,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)a.d(n,o,function(t){return e[t]}.bind(null,o));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],s=r.push.bind(r);r.push=t,r=r.slice();for(var d=0;d<r.length;d++)t(r[d]);var l=s;c.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"4cef":function(e,t,n){"use strict";n("6ebf")},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var o=n("2b0e"),i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-app",[n("v-system-bar",{attrs:{app:""}},[n("span",{staticStyle:{"text-overflow":"ellipsis",overflow:"hidden","white-space":"nowrap"}},[e._v(" Настройка индивидуального устройства ")]),n("v-spacer"),n("nobr",[e.deviceConnectionStatus?n("span",[n("v-icon",{attrs:{dense:""}},[e._v("mdi-usb")]),e._v(e._s(e.deviceConnectionPort)+" ")],1):e._e(),e._v("    "),e.deviceConnectionStatus?n("span",[n("v-icon",{attrs:{dense:""}},[e._v("mdi-checkbox-marked-circle-outline")]),e._v("Подключен ")],1):n("span",[n("v-icon",{attrs:{dense:""}},[e._v("mdi-close-circle-outline")]),e._v("Отключен ")],1)])],1),n("v-main",[e.app.started?e._e():n("v-progress-linear",{attrs:{indeterminate:"",color:"indigo"}}),!e.serverConnectionStatus&&e.app.started?n("div",[n("v-container",[n("v-alert",{attrs:{dense:"",border:"left","colored-border":"",type:"error",elevation:"2"}},[e._v(" Ошибка. Сервер недоступен либо выключен. ")])],1)],1):e._e(),e.serverConnectionStatus&&e.app.started?n("div",[n("v-container",{attrs:{fluid:""}},[n("transition",{attrs:{name:"slide-fade"}},[e.no_comDevice?n("v-alert",{attrs:{dense:"",border:"left","colored-border":"",type:"warning",elevation:"2"}},[e._v(" Нет доступных устройств ")]):e._e()],1),n("transition",{attrs:{name:"slide-fade"}},[e.deviceConnectionStatus?e._e():n("v-form",[n("v-row",[n("v-col",{staticStyle:{"max-height":"65px"},attrs:{cols:"12",md:"6"}},[n("v-select",{attrs:{dense:"",outlined:"",rules:e.formRules.comDevice,label:"Устройство","item-text":"name","item-value":"port",items:e.comData.com_devices,disabled:e.no_comDevice},model:{value:e.input_comDevice,callback:function(t){e.input_comDevice=t},expression:"input_comDevice"}})],1),n("v-col",{staticStyle:{"max-height":"65px"},attrs:{cols:"12",md:"2"}},[n("v-select",{attrs:{items:Object.values(e.comData.com_speed),label:"Скорость",outlined:"",dense:"",disabled:e.no_comDevice},model:{value:e.input_comSpeed,callback:function(t){e.input_comSpeed=t},expression:"input_comSpeed"}})],1),n("v-col",{staticStyle:{"max-height":"60px"},attrs:{cols:"12",md:"2"}},[n("v-btn",{attrs:{outlined:"",color:"indigo",dense:"",disabled:e.no_comDevice||e.tryingConnectComDevice||e.tryingDisconnectComDevice||""==e.input_comDevice||""==e.input_comSpeed,loading:e.tryingConnectComDevice},on:{click:function(t){return e.connectComDevice()}}},[e._v(" Подключиться ")])],1)],1)],1),e.deviceConnectionStatus?n("v-form",[n("div",{staticClass:"d-flex justify-space-between"},[n("div",{staticStyle:{overflow:"hidden","text-overflow":"ellipsis"}}),n("v-btn",{attrs:{outlined:"",color:"red",dense:"",disabled:e.no_comDevice,loading:e.tryingDisconnectComDevice},on:{click:function(t){return e.disconnectComDevice()}}},[e._v(" Отключиться ")])],1)]):e._e()],1),n("transition",{attrs:{name:"slide-fade"}},[n("v-content",[n("v-card",{staticStyle:{"margin-bottom":"10px",height:"200px",overflow:"scroll","overflow-x":"hidden","font-family":"monospace",color:"black"},attrs:{id:"terminal-window"}},[n("v-card-text",{attrs:{disabled:e.no_comDevice||!e.deviceConnectionStatus||e.tryingConnectComDevice||e.tryingDisconnectComDevice}},e._l(e.resp.chat,(function(t){return n("div",{key:t},["user"==t.author?n("span",{staticStyle:{color:"green"}},[e._v(" $~ ")]):"device"==t.author?n("span",{staticStyle:{color:"blue"}},[e._v(" -> ")]):e._e(),e._v(" "+e._s(t.message)+" "),n("br")])})),0)],1),n("v-form",[n("v-row",{attrs:{"no-gutters":""}},[n("v-col",[n("v-text-field",{staticStyle:{"font-family":"monospace"},attrs:{prefix:"~$",solo:"","append-icon":"mdi-send",disabled:e.no_comDevice||!e.deviceConnectionStatus||e.tryingConnectComDevice||e.tryingDisconnectComDevice},on:{"click:append":function(t){return e.sendComCommand(e.input_comCommand)}},model:{value:e.input_comCommand,callback:function(t){e.input_comCommand=t},expression:"input_comCommand"}})],1)],1)],1),n("v-btn",{staticClass:"mb-5",staticStyle:{display:"block","margin-right":"0","margin-left":"auto"},attrs:{outlined:"",color:"red",disabled:e.no_comDevice||!e.deviceConnectionStatus||e.tryingConnectComDevice||e.tryingDisconnectComDevice||""==e.input_comCommand},on:{click:function(t){return e.clearButtons()}}},[e._v(" Очистить ")]),n("v-row",e._l(9,(function(t){return n("div",{key:t},[n("v-col",{staticStyle:{"min-width":"200px",width:"11vw"}},[n("v-card",{attrs:{dense:""}},[n("div",{staticClass:"text-center text-h6"},[e._v(e._s(t))]),n("v-select",{staticClass:"pa-2",attrs:{label:"Действие","item-text":"caption","item-value":"id",items:e.SKB_device.actions,outlined:"",dense:"",disabled:e.no_comDevice||!e.deviceConnectionStatus||e.tryingConnectComDevice||e.tryingDisconnectComDevice},on:{change:function(t){return e.changeSend()}},model:{value:e.buttons[t],callback:function(n){e.$set(e.buttons,t,n)},expression:"buttons[i]"}})],1)],1)],1)})),0)],1)],1)],1)],1):e._e()],1)],1)},c=[],a=(n("b64b"),n("d3b7"),n("bc3a")),r=n.n(a),s={name:"App",components:{},data:function(){return{app:{started:!1,isSendingCommand:!1},SKB_device:{actions:[{id:"1",caption:"Свет вкл."},{id:"2",caption:"Свет выкл."},{id:"3",caption:"Отопление вкл."},{id:"4",caption:"Отопление выкл."},{id:"5",caption:"Газ вкл."},{id:"6",caption:"Газ выкл."},{id:"7",caption:"Вода вкл."},{id:"8",caption:"Вода выкл."}]},buttons:{},resp:"",comData:[],input_comDevice:"",input_comSpeed:9600,no_comDevice:!1,serverConnectionStatus:!1,deviceConnectionStatus:!1,deviceConnectionPort:"",port:"",tryingConnectComDevice:!1,tryingDisconnectComDevice:!1,input_comCommand:"",serverUrl:"http://127.0.0.1:5000",formRules:{comDevice:[function(e){return!!e||"Выберите устройство"}],comSpeed:[function(e){return!!e||"Выберите скорость"}]}}},methods:{changeSend:function(){this.input_comCommand="";for(var e=1;e<=9;e++)void 0!=this.buttons[e]&&(this.input_comCommand+="butt "+e+" actn "+this.buttons[e]+" cl rs ")},clearButtons:function(){this.input_comCommand="",this.buttons={}},checkConnection:function(){var e=this;r.a.get(this.serverUrl+"/check",{timeout:5e3}).then((function(t){"true"==t.data.server_working&&(e.serverConnectionStatus=!0,e.app.started=!0),"true"==t.data.device_connected?e.deviceConnectionStatus=!0:e.deviceConnectionStatus=!1,e.deviceConnectionPort=t.data.device_port})).catch((function(t){e.serverConnectionStatus=!1,e.app.started=!0,console.error(t)}))},getComDevices:function(){var e=this;this.deviceConnectionStatus||r.a.get(this.serverUrl+"/com/show").then((function(t){e.comData=t.data,0===Object.keys(t.data.com_devices).length?e.no_comDevice=!0:e.no_comDevice=!1})).catch((function(e){console.error(e)}))},connectComDevice:function(){var e=this;this.tryingConnectComDevice=!0;var t={"Content-Type":"application/json"};r.a.post(this.serverUrl+"/com/connect",{port:this.input_comDevice,speed:this.input_comSpeed},{headers:t}).then((function(t){console.log(t.data),e.resp=t.data,"success"==t.data.reply?e.deviceConnectionStatus=!0:e.deviceConnectionStatus=!1})).catch((function(e){console.log(e)})).finally((function(){e.tryingConnectComDevice=!1}))},disconnectComDevice:function(){var e=this;this.tryingDisconnectComDevice=!0;var t={"Content-Type":"application/json"};r.a.post(this.serverUrl+"/com/disconnect",{command:"disconnect"},{headers:t}).then((function(t){console.log(t.data),"success"==t.data.reply?e.deviceConnectionStatus=!1:e.deviceConnectionStatus=!0})).catch((function(e){console.log(e)})).finally((function(){e.tryingDisconnectComDevice=!1,e.checkConnection(),e.resp=[]}))},sendComCommand:function(){var e=this;if(""!=this.input_comCommand){this.app.isSendingCommand=!0;var t={"Content-Type":"application/json"};r.a.post(this.serverUrl+"/com/send",{command:this.input_comCommand},{headers:t}).then((function(t){console.log(t.data),e.resp=t.data})).catch((function(e){console.log(e)})).finally((function(){var t=e.$el.querySelector("#terminal-window");t.scrollTop=t.scrollHeight,e.app.isSendingCommand=!1}))}}},mounted:function(){this.checkConnection(),this.getComDevices(),setInterval(function(){this.app.isSendingCommand||this.checkConnection()}.bind(this),2e3),setInterval(function(){this.getComDevices()}.bind(this),2e3)}},d=s,l=(n("4cef"),n("2877")),u=n("6544"),v=n.n(u),m=n("0798"),p=n("7496"),f=n("8336"),h=n("b0af"),C=n("99d9"),_=n("62ad"),b=n("a523"),g=n("a75b"),y=n("4bd4"),D=n("132d"),S=n("f6c4"),w=n("8e36"),x=n("0fd9"),k=n("b974"),V=n("2fa4"),j=n("afd9"),O=n("8654"),P=Object(l["a"])(d,i,c,!1,null,"3be18c5a",null),T=P.exports;v()(P,{VAlert:m["a"],VApp:p["a"],VBtn:f["a"],VCard:h["a"],VCardText:C["a"],VCol:_["a"],VContainer:b["a"],VContent:g["a"],VForm:y["a"],VIcon:D["a"],VMain:S["a"],VProgressLinear:w["a"],VRow:x["a"],VSelect:k["a"],VSpacer:V["a"],VSystemBar:j["a"],VTextField:O["a"]});var B=n("f309");o["a"].use(B["a"]);var U=new B["a"]({});o["a"].config.productionTip=!1,new o["a"]({vuetify:U,render:function(e){return e(T)}}).$mount("#app")},"6ebf":function(e,t,n){}});
//# sourceMappingURL=app.7049bcd7.js.map